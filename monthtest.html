<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>客戶資料轉移系統</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: #f0f5ff;
        }
        .card {
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }
        .card:hover {
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }
        .btn-primary {
            background-color: #3b82f6;
            transition: all 0.3s ease;
        }
        .btn-primary:hover {
            background-color: #2563eb;
        }
        .btn-secondary {
            background-color: #6b7280;
            transition: all 0.3s ease;
        }
        .btn-secondary:hover {
            background-color: #4b5563;
        }
        .btn-success {
            background-color: #10b981;
            transition: all 0.3s ease;
        }
        .btn-success:hover {
            background-color: #059669;
        }
        .fade-in {
            animation: fadeIn 0.5s ease-in-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* 列印樣式 */
        @media print {
            body * {
                visibility: hidden;
            }
            #printArea, #printArea * {
                visibility: visible;
            }
            #printArea {
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
                padding: 20px;
                background-color: white;
            }
            .no-print {
                display: none !important;
            }
        }
        
        /* 確保列印區域在列印時可見 */
        #printArea {
            display: none;
            background-color: white;
            padding: 20px;
            margin: 0 auto;
            max-width: 800px;
            font-size: 12px; /* 縮小字體大小 */
        }
        
        /* 載入指示器 */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            display: none;
        }
        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 5px solid #f3f3f3;
            border-top: 5px solid #3498db;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Google文件風格的下載對話框 */
        .google-dialog {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
            width: 400px;
            max-width: 90%;
            z-index: 10000;
            display: none;
        }
        .google-dialog-header {
            padding: 16px 24px;
            border-bottom: 1px solid #e0e0e0;
        }
        .google-dialog-body {
            padding: 20px 24px;
        }
        .google-dialog-footer {
            padding: 12px 24px;
            display: flex;
            justify-content: flex-end;
            border-top: 1px solid #e0e0e0;
        }
        .google-btn {
            padding: 8px 24px;
            border-radius: 4px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            margin-left: 8px;
        }
        .google-btn-cancel {
            color: #1a73e8;
            background: transparent;
        }
        .google-btn-cancel:hover {
            background-color: rgba(26, 115, 232, 0.04);
        }
        .google-btn-primary {
            background-color: #1a73e8;
            color: white;
        }
        .google-btn-primary:hover {
            background-color: #1765cc;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
        }
        .google-radio {
            display: flex;
            align-items: center;
            margin-bottom: 16px;
            cursor: pointer;
        }
        .google-radio input {
            margin-right: 12px;
        }
        .google-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 9999;
            display: none;
        }
        .format-description {
            color: #5f6368;
            font-size: 13px;
            margin-left: 24px;
        }
        
        /* 下載成功通知 */
        .download-toast {
            position: fixed;
            bottom: 24px;
            left: 50%;
            transform: translateX(-50%);
            background-color: #323232;
            color: white;
            padding: 12px 24px;
            border-radius: 4px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
            display: flex;
            align-items: center;
            z-index: 10001;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        .download-toast.show {
            opacity: 1;
        }
        .download-toast-icon {
            margin-right: 12px;
        }
        
        /* 調整頁面縮放選項 */
        .page-scale-options {
            margin-top: 10px;
            padding: 10px;
            background-color: #f5f5f5;
            border-radius: 4px;
        }
        
        .page-scale-options label {
            margin-right: 15px;
            cursor: pointer;
        }
        
        /* 新的Google文件風格PDF樣式 */
        .google-doc-container {
            width: 210mm; /* A4寬度 */
            padding: 20mm 15mm; /* 上下左右邊距 */
            background-color: white;
            box-sizing: border-box;
            font-family: 'Noto Sans TC', Arial, sans-serif;
            line-height: 1.5;
        }
        
        .doc-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
            border-bottom: 1px solid #000;
            padding-bottom: 10px;
        }
        
        .doc-header-left {
            display: flex;
            align-items: center;
        }
        
        .doc-logo {
            width: 120px;
            margin-right: 15px;
        }
        
        .doc-company-info {
            font-size: 12px;
        }
        
        .doc-company-name {
            font-weight: bold;
            font-size: 16px;
            margin-bottom: 3px;
        }
        
        .doc-header-right {
            text-align: right;
            font-size: 12px;
        }
        
        .doc-title {
            text-align: center;
            font-size: 20px;
            font-weight: bold;
            margin: 15px 0;
        }
        
        .doc-section {
            margin-bottom: 15px;
        }
        
        .doc-section-title {
            background-color: #f2f2f2;
            padding: 5px;
            font-weight: bold;
            font-size: 14px;
            margin-bottom: 5px;
        }
        
        .doc-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 10px;
        }
        
        .doc-table th, .doc-table td {
            border: 1px solid #000;
            padding: 5px;
            font-size: 12px;
        }
        
        .doc-table th {
            background-color: #f2f2f2;
            font-weight: bold;
            text-align: center;
        }
        
        .doc-notice-box {
            border: 1px solid #000;
            padding: 10px;
            margin-bottom: 15px;
        }
        
        .doc-notice-title {
            text-align: center;
            font-weight: bold;
            margin-bottom: 5px;
            font-size: 14px;
        }
        
        .doc-notice-list {
            padding-left: 20px;
            font-size: 11px;
        }
        
        .doc-notice-list li {
            margin-bottom: 3px;
        }
        
        .doc-signature-box {
            display: flex;
            width: 100%;
            margin-top: 15px;
        }
        
        .doc-signature-cell {
            flex: 1;
            border: 1px solid #000;
            height: 70px;
            padding: 5px;
            text-align: center;
            font-size: 12px;
        }
        
        .doc-footer {
            margin-top: 10px;
            text-align: right;
            font-size: 11px;
        }
    </style>
</head>
<body>
    <!-- 載入指示器 -->
    <div id="loadingOverlay" class="loading-overlay">
        <div class="bg-white p-6 rounded-lg shadow-lg text-center">
            <div class="loading-spinner mx-auto mb-4"></div>
            <p id="loadingText" class="text-lg font-medium text-gray-700">正在處理，請稍候...</p>
        </div>
    </div>

    <!-- Google風格下載對話框 -->
    <div id="googleOverlay" class="google-overlay"></div>
    <div id="googleDialog" class="google-dialog">
        <div class="google-dialog-header">
            <h3 class="text-xl font-medium text-gray-800">下載</h3>
        </div>
        <div class="google-dialog-body">
            <p class="mb-4 text-gray-700">選擇檔案格式：</p>
            
            <label class="google-radio">
                <input type="radio" name="fileFormat" value="pdf" checked>
                <div>
                    <div class="font-medium">PDF 文件 (.pdf)</div>
                    <div class="format-description">適合正式文件，保留精確格式</div>
                </div>
            </label>
            
            <label class="google-radio">
                <input type="radio" name="fileFormat" value="png">
                <div>
                    <div class="font-medium">PNG 圖片 (.png)</div>
                    <div class="format-description">高品質圖片格式，適合列印或分享</div>
                </div>
            </label>
            
            <label class="google-radio">
                <input type="radio" name="fileFormat" value="jpg">
                <div>
                    <div class="font-medium">JPEG 圖片 (.jpg)</div>
                    <div class="format-description">較小的檔案大小，適合電子郵件附件</div>
                </div>
            </label>
            
            <div class="page-scale-options mt-4 pt-4 border-t border-gray-200">
                <p class="mb-3 text-gray-700 font-medium">頁面縮放：</p>
                <div class="flex flex-wrap">
                    <label class="flex items-center mb-2">
                        <input type="radio" name="pageScale" value="fit" checked class="mr-2">
                        <span>自動縮放至一頁</span>
                    </label>
                    <label class="flex items-center mb-2">
                        <input type="radio" name="pageScale" value="actual" class="mr-2">
                        <span>實際大小</span>
                    </label>
                </div>
            </div>
        </div>
        <div class="google-dialog-footer">
            <button id="cancelDownload" class="google-btn google-btn-cancel">取消</button>
            <button id="confirmDownload" class="google-btn google-btn-primary">下載</button>
        </div>
    </div>

    <!-- 下載成功通知 -->
    <div id="downloadToast" class="download-toast">
        <div class="download-toast-icon">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z" fill="white"/>
            </svg>
        </div>
        <span>下載已開始</span>
    </div>

    <div class="container mx-auto px-4 py-8 max-w-6xl">
        <header class="mb-8">
            <h1 class="text-3xl font-bold text-center text-gray-800">客戶資料轉移系統</h1>
            <p class="text-center text-gray-600 mt-2">將A客戶的使用權限轉移給B客戶</p>
        </header>

        <div id="inputForm">
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                <!-- A客戶資料卡 -->
                <div class="card bg-white rounded-lg p-6">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-xl font-bold text-gray-800">A客戶資料 (轉出方)</h2>
                        <div class="flex items-center">
                            <span id="customerAStatus" class="mr-2 hidden text-green-600">✓ 已載入</span>
                            <button id="searchA" class="btn-primary text-white px-4 py-2 rounded-md">查詢客戶</button>
                        </div>
                    </div>
                    
                    <div class="mb-4">
                        <label class="block text-gray-700 mb-2">客戶編號</label>
                        <input type="text" id="customerA_id" class="w-full px-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="請輸入客戶編號">
                    </div>
                    
                    <div class="mb-4">
                        <label class="block text-gray-700 mb-2">姓名</label>
                        <input type="text" id="customerA_name" class="w-full px-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="請輸入姓名">
                    </div>
                    
                    <div class="mb-4">
                        <label class="block text-gray-700 mb-2">地址</label>
                        <input type="text" id="customerA_address" class="w-full px-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="請輸入地址">
                    </div>
                    
                    <div class="grid grid-cols-2 gap-4 mb-4">
                        <div>
                            <label class="block text-gray-700 mb-2">電話</label>
                            <input type="text" id="customerA_phone" class="w-full px-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="請輸入電話">
                        </div>
                        <div>
                            <label class="block text-gray-700 mb-2">使用期限</label>
                            <input type="date" id="customerA_expiry" class="w-full px-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                        </div>
                    </div>
                    
                    <div class="mb-4">
                        <label class="block text-gray-700 mb-2">剩餘天數</label>
                        <input type="text" id="customerA_daysLeft" class="w-full px-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="自動計算或手動輸入">
                    </div>
                </div>

                <!-- B客戶資料卡 -->
                <div class="card bg-white rounded-lg p-6">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-xl font-bold text-gray-800">B客戶資料 (接收方)</h2>
                        <div class="flex items-center">
                            <span id="customerBStatus" class="mr-2 hidden text-green-600">✓ 已載入</span>
                            <button id="searchB" class="btn-primary text-white px-4 py-2 rounded-md">查詢客戶</button>
                        </div>
                    </div>
                    
                    <div class="mb-4">
                        <label class="block text-gray-700 mb-2">客戶編號</label>
                        <input type="text" id="customerB_id" class="w-full px-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="請輸入客戶編號">
                    </div>
                    
                    <div class="mb-4">
                        <label class="block text-gray-700 mb-2">姓名</label>
                        <input type="text" id="customerB_name" class="w-full px-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="請輸入姓名">
                    </div>
                    
                    <div class="mb-4">
                        <label class="block text-gray-700 mb-2">地址</label>
                        <input type="text" id="customerB_address" class="w-full px-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="請輸入地址">
                    </div>
                    
                    <div class="grid grid-cols-2 gap-4 mb-4">
                        <div>
                            <label class="block text-gray-700 mb-2">電話</label>
                            <input type="text" id="customerB_phone" class="w-full px-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="請輸入電話">
                        </div>
                        <div>
                            <label class="block text-gray-700 mb-2">目前使用期限</label>
                            <input type="date" id="customerB_currentExpiry" class="w-full px-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                        </div>
                    </div>
                    
                    <div class="mb-4">
                        <label class="block text-gray-700 mb-2">轉移後到期日</label>
                        <input type="date" id="customerB_newExpiry" class="w-full px-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                </div>
            </div>

            <!-- 轉移設定區域 -->
            <div class="card bg-white rounded-lg p-6 mt-8">
                <h2 class="text-xl font-bold text-gray-800 mb-6">轉移設定</h2>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label class="block text-gray-700 mb-2">轉移日期</label>
                        <input type="date" id="transferDate" class="w-full px-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                    
                    <div>
                        <label class="block text-gray-700 mb-2">轉移天數</label>
                        <input type="text" id="transferDays" class="w-full px-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="自動計算或手動輸入">
                    </div>
                </div>
                
                <div class="mt-6">
                    <label class="block text-gray-700 mb-2">轉移備註</label>
                    <textarea id="transferNotes" class="w-full px-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" rows="3" placeholder="請輸入轉移原因或其他備註"></textarea>
                </div>
            </div>

            <!-- 操作按鈕 -->
            <div class="flex justify-center mt-8 space-x-4">
                <button id="calculateBtn" class="btn-primary text-white px-6 py-3 rounded-md font-medium">計算轉移資訊</button>
                <button id="transferBtn" class="btn-success text-white px-6 py-3 rounded-md font-medium">確認轉移</button>
                <button id="resetBtn" class="btn-secondary text-white px-6 py-3 rounded-md font-medium">重置表單</button>
            </div>
        </div>

        <!-- 轉移結果顯示區域 -->
        <div id="resultArea" class="mt-8 hidden fade-in">
            <div class="card bg-green-50 border-l-4 border-green-500 p-6 mb-8">
                <div class="flex items-center mb-4">
                    <svg class="w-6 h-6 text-green-600 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                    </svg>
                    <h3 class="text-lg font-bold text-green-700">轉移成功</h3>
                </div>
                <p id="resultMessage" class="text-green-600 mb-4"></p>
                <div class="flex justify-end">
                    <button id="backToForm" class="text-blue-600 hover:text-blue-800 font-medium">返回表單</button>
                </div>
            </div>

            <!-- 轉移詳細資訊 -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                <!-- 轉讓戶資料 -->
                <div class="card bg-white rounded-lg p-6">
                    <h2 class="text-xl font-bold text-gray-800 mb-6 flex items-center">
                        <svg class="w-5 h-5 text-red-500 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                        </svg>
                        轉讓戶資料
                    </h2>
                    
                    <div class="mb-4">
                        <label class="block text-gray-500 text-sm mb-1">客戶編號</label>
                        <p id="result_transferor_id" class="text-gray-800 font-medium"></p>
                    </div>
                    
                    <div class="mb-4">
                        <label class="block text-gray-500 text-sm mb-1">姓名</label>
                        <p id="result_transferor_name" class="text-gray-800 font-medium"></p>
                    </div>
                    
                    <div class="mb-4">
                        <label class="block text-gray-500 text-sm mb-1">地址</label>
                        <p id="result_transferor_address" class="text-gray-800 font-medium"></p>
                    </div>
                    
                    <div class="grid grid-cols-2 gap-4 mb-4">
                        <div>
                            <label class="block text-gray-500 text-sm mb-1">電話</label>
                            <p id="result_transferor_phone" class="text-gray-800 font-medium"></p>
                        </div>
                        <div>
                            <label class="block text-gray-500 text-sm mb-1">原使用期限</label>
                            <p id="result_transferor_expiry" class="text-gray-800 font-medium"></p>
                        </div>
                    </div>
                    
                    <div class="mb-4">
                        <label class="block text-gray-500 text-sm mb-1">轉移時間</label>
                        <p id="result_transferPeriod" class="text-gray-800 font-medium"></p>
                    </div>
                </div>

                <!-- 承接者資料 -->
                <div class="card bg-white rounded-lg p-6">
                    <h2 class="text-xl font-bold text-gray-800 mb-6 flex items-center">
                        <svg class="w-5 h-5 text-green-500 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 15l7-7 7 7"></path>
                        </svg>
                        承接者資料
                    </h2>
                    
                    <div class="mb-4">
                        <label class="block text-gray-500 text-sm mb-1">客戶編號</label>
                        <p id="result_recipient_id" class="text-gray-800 font-medium"></p>
                    </div>
                    
                    <div class="mb-4">
                        <label class="block text-gray-500 text-sm mb-1">姓名</label>
                        <p id="result_recipient_name" class="text-gray-800 font-medium"></p>
                    </div>
                    
                    <div class="mb-4">
                        <label class="block text-gray-500 text-sm mb-1">地址</label>
                        <p id="result_recipient_address" class="text-gray-800 font-medium"></p>
                    </div>
                    
                    <div class="grid grid-cols-2 gap-4 mb-4">
                        <div>
                            <label class="block text-gray-500 text-sm mb-1">電話</label>
                            <p id="result_recipient_phone" class="text-gray-800 font-medium"></p>
                        </div>
                        <div>
                            <label class="block text-gray-500 text-sm mb-1">原使用期限</label>
                            <p id="result_recipient_oldExpiry" class="text-gray-800 font-medium"></p>
                        </div>
                    </div>
                    
                    <div class="mb-4">
                        <label class="block text-gray-500 text-sm mb-1">新使用期限</label>
                        <p id="result_recipient_newExpiry" class="text-gray-800 font-medium text-green-600"></p>
                    </div>
                </div>
            </div>

            <!-- 轉移詳情 -->
            <div class="card bg-white rounded-lg p-6 mt-8">
                <h2 class="text-xl font-bold text-gray-800 mb-6">轉移詳情</h2>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label class="block text-gray-500 text-sm mb-1">轉移日期</label>
                        <p id="result_transferDate" class="text-gray-800 font-medium"></p>
                    </div>
                    
                    <div>
                        <label class="block text-gray-500 text-sm mb-1">轉移單號</label>
                        <p id="result_transferId" class="text-gray-800 font-medium"></p>
                    </div>
                </div>
                
                <div class="mt-6">
                    <label class="block text-gray-500 text-sm mb-1">轉移備註</label>
                    <p id="result_transferNotes" class="text-gray-800"></p>
                </div>

                <div class="mt-6 p-4 bg-blue-50 rounded-md">
                    <p class="text-blue-800 text-sm">此轉移已成功完成，系統已更新雙方客戶的使用期限資料。</p>
                </div>
            </div>

            <!-- 列印按鈕 -->
            <div class="flex justify-center mt-8 space-x-4">
                <button id="printBtn" class="btn-primary text-white px-6 py-3 rounded-md font-medium flex items-center">
                    <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"></path>
                    </svg>
                    列印轉移單
                </button>
                <button id="downloadBtn" class="btn-success text-white px-6 py-3 rounded-md font-medium flex items-center">
                    <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path>
                    </svg>
                    下載檔案
                </button>
            </div>
        </div>

        <!-- 列印區域 - 使用Google文件風格 -->
        <div id="printArea" class="google-doc-container">
            <!-- 表頭 -->
            <div class="doc-header">
                <div class="doc-header-left">
                    <!-- 今網智生活Logo -->
                    <img src="https://lh3.googleusercontent.com/d/1Hs-Ug0Yx_Nh9Ov9HlIRuGpLRJO-nTMqn" alt="今網智生活Logo" class="doc-logo">
                    <div class="doc-company-info">
                        <div class="doc-company-name">今網智慧科技股份有限公司</div>
                        <div>統一編號：54307560</div>
                    </div>
                </div>
                <div class="doc-header-right">
                    <div>版本：20250206_V1.0</div>
                    <div>申請日期：<span id="print_application_date"></span></div>
                </div>
            </div>

            <!-- 標題 -->
            <div class="doc-title">月份轉移申請書</div>

            <!-- 轉讓戶資料 -->
            <div class="doc-section">
                <div class="doc-section-title">轉讓戶資料</div>
                <table class="doc-table">
                    <tr>
                        <td style="width: 25%; background-color: #f2f2f2;">客戶編號</td>
                        <td style="width: 25%;" id="print_transferor_id"></td>
                        <td style="width: 25%; background-color: #f2f2f2;">客戶姓名</td>
                        <td style="width: 25%;" id="print_transferor_name"></td>
                    </tr>
                    <tr>
                        <td style="background-color: #f2f2f2;">電話</td>
                        <td id="print_transferor_phone"></td>
                        <td style="background-color: #f2f2f2;">到期日</td>
                        <td id="print_transferor_expiry"></td>
                    </tr>
                    <tr>
                        <td style="background-color: #f2f2f2;">地址</td>
                        <td colspan="3" id="print_transferor_address"></td>
                    </tr>
                </table>
            </div>

            <!-- 承接者資料 -->
            <div class="doc-section">
                <div class="doc-section-title">承接者資料</div>
                <table class="doc-table">
                    <tr>
                        <td style="width: 25%; background-color: #f2f2f2;">客戶編號</td>
                        <td style="width: 25%;" id="print_recipient_id"></td>
                        <td style="width: 25%; background-color: #f2f2f2;">客戶姓名</td>
                        <td style="width: 25%;" id="print_recipient_name"></td>
                    </tr>
                    <tr>
                        <td style="background-color: #f2f2f2;">地址</td>
                        <td colspan="3" id="print_recipient_address"></td>
                    </tr>
                    <tr>
                        <td style="background-color: #f2f2f2;">轉移起始日</td>
                        <td id="print_transfer_start_date"></td>
                        <td style="background-color: #f2f2f2;">轉移時間</td>
                        <td id="print_transfer_period"></td>
                    </tr>
                    <tr>
                        <td style="background-color: #f2f2f2;">轉移後新到期日</td>
                        <td colspan="3" id="print_recipient_newExpiry"></td>
                    </tr>
                </table>
            </div>

            <!-- 注意事項 -->
            <div class="doc-notice-box">
                <div class="doc-notice-title">【注意事項】</div>
                <div style="text-align: center; margin-bottom: 5px; font-size: 12px;">申請程序如下(未盡細項詳租用條款第七條各項)：</div>
                <ol class="doc-notice-list">
                    <li>各項異動服務需填具申請書/並檢附登記人雙證件影本方可辦理。</li>
                    <li>每次暫停期間最長1年，暫停復訊後需屆滿15天，方可再辦理暫停。</li>
                    <li>用戶有主分機者，辦理暫停則主分機將一併暫停。</li>
                    <li>網路暫停天數將如數延長於網路到期日之後。</li>
                    <li>接受月份轉移者，轉移之月份、天數不得再次轉移，亦不得列入退費計算。承接人享月份使用權益，退費權益仍屬原登記人，雙方因月份轉移而肇致糾紛，由轉移雙方當事人負責。</li>
                    <li>本申請書之登記人及承接人應確實填具上開資料，如有錯誤或偽冒，願負法律責任。上開資料，本公司僅作申辦異動業務及聯絡使用。</li>
                    <li>本公司保證依隱私權保護相關法令之規定，保護登記人及承接人所提供之資料，除依法律規定、法院命令或相關主管機關依法以書面申請，不得提供與第三人使用。</li>
                </ol>
            </div>

            <!-- 回傳方式 -->
            <div class="doc-notice-box">
                <div style="text-align: center; margin-bottom: 5px; font-size: 12px; font-weight: bold;">回傳方式：本申請書(含證件)，方可透過以下方式回傳並來電412-8166(手機需加區碼)確認，避免遺漏。</div>
                <ol class="doc-notice-list">
                    <li>郵寄：40466-台中市北區太原北路130號10樓</li>
                    <li>MAIL：service@smartdaily.com.tw</li>
                </ol>
            </div>

            <!-- 簽名欄 -->
            <div class="doc-signature-box">
                <div class="doc-signature-cell">
                    <div style="margin-bottom: 5px;">會辦單位</div>
                </div>
                <div class="doc-signature-cell">
                    <div style="margin-bottom: 5px;">主管</div>
                </div>
                <div class="doc-signature-cell">
                    <div style="margin-bottom: 5px;">服務人員</div>
                </div>
                <div class="doc-signature-cell">
                    <div style="margin-bottom: 5px;">客戶簽名</div>
                </div>
            </div>

            <!-- 轉移單號 -->
            <div class="doc-footer">
                <div>轉移單號：<span id="print_transfer_id"></span></div>
            </div>
        </div>
    </div>

    <script>
        // 確保jsPDF已載入
        window.jsPDF = window.jspdf.jsPDF;
        
        // 模擬客戶資料庫
        const customerDatabase = {
            'A001': {
                name: '王小明',
                address: '台北市信義區信義路五段7號',
                phone: '0912-345-678',
                expiry: '2024-12-31'
            },
            'A002': {
                name: '李小華',
                address: '新北市板橋區文化路一段88號',
                phone: '0923-456-789',
                expiry: '2024-10-15'
            },
            'B001': {
                name: '張大為',
                address: '台中市西區民生路200號',
                phone: '0934-567-890',
                expiry: '2024-08-20'
            },
            'B002': {
                name: '林美玲',
                address: '高雄市前鎮區中山路99號',
                phone: '0945-678-901',
                expiry: '2024-09-05'
            }
        };

        // 顯示載入指示器
        function showLoading(message) {
            document.getElementById('loadingText').textContent = message || '處理中，請稍候...';
            document.getElementById('loadingOverlay').style.display = 'flex';
        }

        // 隱藏載入指示器
        function hideLoading() {
            document.getElementById('loadingOverlay').style.display = 'none';
        }

        // 顯示Google風格下載對話框
        function showGoogleDialog() {
            document.getElementById('googleOverlay').style.display = 'block';
            document.getElementById('googleDialog').style.display = 'block';
        }

        // 隱藏Google風格下載對話框
        function hideGoogleDialog() {
            document.getElementById('googleOverlay').style.display = 'none';
            document.getElementById('googleDialog').style.display = 'none';
        }

        // 顯示下載成功通知
        function showDownloadToast() {
            const toast = document.getElementById('downloadToast');
            toast.classList.add('show');
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }

        // 計算兩個日期之間的天數差
        function daysBetween(date1, date2) {
            const oneDay = 24 * 60 * 60 * 1000; // 一天的毫秒數
            const firstDate = new Date(date1);
            const secondDate = new Date(date2);
            return Math.round((secondDate - firstDate) / oneDay);
        }

        // 添加天數到日期
        function addDays(date, days) {
            const result = new Date(date);
            result.setDate(result.getDate() + parseInt(days));
            return result;
        }

        // 格式化日期為 YYYY-MM-DD
        function formatDate(date) {
            const d = new Date(date);
            const month = String(d.getMonth() + 1).padStart(2, '0');
            const day = String(d.getDate()).padStart(2, '0');
            return `${d.getFullYear()}-${month}-${day}`;
        }

        // 格式化日期為顯示格式
        function formatDisplayDate(dateStr) {
            if (!dateStr) return '';
            
            try {
                const d = new Date(dateStr);
                if (isNaN(d.getTime())) return dateStr; // 如果日期無效，直接返回原始字串
                
                const year = d.getFullYear();
                const month = String(d.getMonth() + 1).padStart(2, '0');
                const day = String(d.getDate()).padStart(2, '0');
                return `${year}年${month}月${day}日`;
            } catch (e) {
                return dateStr; // 如果發生錯誤，直接返回原始字串
            }
        }

        // 生成隨機轉移單號
        function generateTransferId() {
            const date = new Date();
            const year = date.getFullYear();
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const day = String(date.getDate()).padStart(2, '0');
            const random = Math.floor(Math.random() * 10000).toString().padStart(4, '0');
            return `T${year}${month}${day}${random}`;
        }

        // 將天數轉換為月份和天數
        function daysToMonthsAndDays(days) {
            if (!days || isNaN(days)) return '';
            
            days = parseInt(days);
            const months = Math.floor(days / 30);
            const remainingDays = days % 30;
            
            if (months > 0 && remainingDays > 0) {
                return `${months}個月${remainingDays}天`;
            } else if (months > 0) {
                return `${months}個月`;
            } else {
                return `${days}天`;
            }
        }

        // 查詢A客戶資料
        document.getElementById('searchA').addEventListener('click', function() {
            const customerId = document.getElementById('customerA_id').value;
            if (!customerId) {
                alert('請輸入客戶編號');
                return;
            }
            
            const customer = customerDatabase[customerId];
            
            if (customer) {
                document.getElementById('customerA_name').value = customer.name;
                document.getElementById('customerA_address').value = customer.address;
                document.getElementById('customerA_phone').value = customer.phone;
                document.getElementById('customerA_expiry').value = customer.expiry;
                
                // 計算剩餘天數
                const today = new Date();
                const expiryDate = new Date(customer.expiry);
                const daysLeft = daysBetween(today, expiryDate);
                document.getElementById('customerA_daysLeft').value = daysLeft;
                
                // 顯示已載入狀態
                document.getElementById('customerAStatus').classList.remove('hidden');
            } else {
                alert('找不到此客戶資料');
                document.getElementById('customerAStatus').classList.add('hidden');
            }
        });

        // 查詢B客戶資料
        document.getElementById('searchB').addEventListener('click', function() {
            const customerId = document.getElementById('customerB_id').value;
            if (!customerId) {
                alert('請輸入客戶編號');
                return;
            }
            
            const customer = customerDatabase[customerId];
            
            if (customer) {
                document.getElementById('customerB_name').value = customer.name;
                document.getElementById('customerB_address').value = customer.address;
                document.getElementById('customerB_phone').value = customer.phone;
                document.getElementById('customerB_currentExpiry').value = customer.expiry;
                
                // 顯示已載入狀態
                document.getElementById('customerBStatus').classList.remove('hidden');
            } else {
                alert('找不到此客戶資料');
                document.getElementById('customerBStatus').classList.add('hidden');
            }
        });

        // 計算轉移資訊
        document.getElementById('calculateBtn').addEventListener('click', function() {
            const transferDate = document.getElementById('transferDate').value;
            const customerAExpiry = document.getElementById('customerA_expiry').value;
            const customerBExpiry = document.getElementById('customerB_currentExpiry').value;
            
            if (!transferDate) {
                alert('請選擇轉移日期');
                return;
            }
            
            if (!customerAExpiry) {
                alert('請設定A客戶的使用期限');
                return;
            }
            
            if (!customerBExpiry) {
                alert('請設定B客戶的目前使用期限');
                return;
            }
            
            // 計算A客戶從轉移日到到期日的剩餘天數
            const transferDays = daysBetween(transferDate, customerAExpiry);
            
            // 確保轉移天數為正數
            if (transferDays <= 0) {
                alert('轉移日期必須早於A客戶的使用期限');
                document.getElementById('transferDays').value = '無效的轉移日期';
                document.getElementById('customerB_newExpiry').value = '';
                return;
            }
            
            // 顯示轉移天數（月份+天數格式）
            const transferPeriod = daysToMonthsAndDays(transferDays);
            document.getElementById('transferDays').value = transferPeriod;
            
            // 計算B客戶的新到期日
            const newExpiryDate = addDays(new Date(customerBExpiry), transferDays);
            document.getElementById('customerB_newExpiry').value = formatDate(newExpiryDate);
        });

        // 確認轉移
        document.getElementById('transferBtn').addEventListener('click', function() {
            const customerAId = document.getElementById('customerA_id').value;
            const customerBId = document.getElementById('customerB_id').value;
            const transferDate = document.getElementById('transferDate').value;
            
            // 檢查必填欄位
            if (!customerAId || !customerBId) {
                alert('請填寫A客戶和B客戶的編號');
                return;
            }
            
            if (!transferDate) {
                alert('請選擇轉移日期');
                return;
            }
            
            // 獲取轉移天數，如果沒有計算過，嘗試計算
            let transferDays = document.getElementById('transferDays').value;
            let newExpiry = document.getElementById('customerB_newExpiry').value;
            
            if (!transferDays || !newExpiry) {
                const customerAExpiry = document.getElementById('customerA_expiry').value;
                const customerBExpiry = document.getElementById('customerB_currentExpiry').value;
                
                if (customerAExpiry && customerBExpiry) {
                    // 計算轉移天數
                    const days = daysBetween(transferDate, customerAExpiry);
                    if (days > 0) {
                        transferDays = daysToMonthsAndDays(days);
                        document.getElementById('transferDays').value = transferDays;
                        
                        // 計算新到期日
                        const newExpiryDate = addDays(new Date(customerBExpiry), days);
                        newExpiry = formatDate(newExpiryDate);
                        document.getElementById('customerB_newExpiry').value = newExpiry;
                    } else {
                        alert('轉移日期必須早於A客戶的使用期限');
                        return;
                    }
                } else {
                    alert('請填寫A客戶和B客戶的使用期限');
                    return;
                }
            }
            
            // 生成轉移單號
            const transferId = generateTransferId();
            
            // 隱藏表單，顯示結果
            document.getElementById('inputForm').classList.add('hidden');
            document.getElementById('resultArea').classList.remove('hidden');
            
            // 設置轉移成功訊息
            document.getElementById('resultMessage').textContent = 
                `已成功將 ${customerAId} 的 ${transferDays} 使用權限轉移給 ${customerBId}。`;
            
            // 填充轉讓戶資料
            document.getElementById('result_transferor_id').textContent = customerAId;
            document.getElementById('result_transferor_name').textContent = document.getElementById('customerA_name').value;
            document.getElementById('result_transferor_address').textContent = document.getElementById('customerA_address').value;
            document.getElementById('result_transferor_phone').textContent = document.getElementById('customerA_phone').value;
            document.getElementById('result_transferor_expiry').textContent = formatDisplayDate(document.getElementById('customerA_expiry').value);
            document.getElementById('result_transferPeriod').textContent = transferDays;
            
            // 填充承接者資料
            document.getElementById('result_recipient_id').textContent = customerBId;
            document.getElementById('result_recipient_name').textContent = document.getElementById('customerB_name').value;
            document.getElementById('result_recipient_address').textContent = document.getElementById('customerB_address').value;
            document.getElementById('result_recipient_phone').textContent = document.getElementById('customerB_phone').value;
            document.getElementById('result_recipient_oldExpiry').textContent = formatDisplayDate(document.getElementById('customerB_currentExpiry').value);
            document.getElementById('result_recipient_newExpiry').textContent = formatDisplayDate(newExpiry);
            
            // 填充轉移詳情
            document.getElementById('result_transferDate').textContent = formatDisplayDate(transferDate);
            document.getElementById('result_transferId').textContent = transferId;
            document.getElementById('result_transferNotes').textContent = document.getElementById('transferNotes').value || '無';
            
            // 填充列印區域資料
            document.getElementById('print_application_date').textContent = formatDisplayDate(new Date());
            document.getElementById('print_transferor_id').textContent = customerAId;
            document.getElementById('print_transferor_name').textContent = document.getElementById('customerA_name').value;
            document.getElementById('print_transferor_phone').textContent = document.getElementById('customerA_phone').value;
            document.getElementById('print_transferor_address').textContent = document.getElementById('customerA_address').value;
            document.getElementById('print_transferor_expiry').textContent = formatDisplayDate(document.getElementById('customerA_expiry').value);
            
            document.getElementById('print_recipient_id').textContent = customerBId;
            document.getElementById('print_recipient_name').textContent = document.getElementById('customerB_name').value;
            document.getElementById('print_recipient_address').textContent = document.getElementById('customerB_address').value;
            document.getElementById('print_transfer_start_date').textContent = formatDisplayDate(transferDate);
            document.getElementById('print_transfer_period').textContent = transferDays;
            document.getElementById('print_recipient_newExpiry').textContent = formatDisplayDate(newExpiry);
            document.getElementById('print_transfer_id').textContent = transferId;
        });

        // 返回表單
        document.getElementById('backToForm').addEventListener('click', function() {
            document.getElementById('resultArea').classList.add('hidden');
            document.getElementById('inputForm').classList.remove('hidden');
        });

        // 列印轉移單
        document.getElementById('printBtn').addEventListener('click', function() {
            // 顯示列印區域
            const printArea = document.getElementById('printArea');
            printArea.style.display = 'block';
            
            // 使用setTimeout確保DOM已更新
            setTimeout(function() {
                window.print();
                
                // 列印完成後隱藏列印區域
                setTimeout(function() {
                    printArea.style.display = 'none';
                }, 1000);
            }, 500);
        });
        
        // 下載按鈕 - 顯示Google風格對話框
        document.getElementById('downloadBtn').addEventListener('click', function() {
            showGoogleDialog();
        });
        
        // 取消下載
        document.getElementById('cancelDownload').addEventListener('click', function() {
            hideGoogleDialog();
        });
        
        // 確認下載
        document.getElementById('confirmDownload').addEventListener('click', function() {
            hideGoogleDialog();
            
            // 獲取選擇的檔案格式
            const fileFormat = document.querySelector('input[name="fileFormat"]:checked').value;
            
            // 獲取頁面縮放選項
            const pageScale = document.querySelector('input[name="pageScale"]:checked').value;
            
            // 獲取必要的數據
            const customerAId = document.getElementById('result_transferor_id').textContent;
            const customerBId = document.getElementById('result_recipient_id').textContent;
            const transferId = document.getElementById('result_transferId').textContent;
            
            // 檔案名稱
            const fileName = `月份轉移申請書_${customerAId}_${customerBId}_${transferId}`;
            
            // 顯示載入指示器
            showLoading('正在生成檔案，請稍候...');
            
            // 顯示列印區域
            const printArea = document.getElementById('printArea');
            printArea.style.display = 'block';
            
            // 確保圖片已載入
            const logoImg = new Image();
            logoImg.onload = function() {
                // 確保DOM已更新後再進行轉換
                setTimeout(function() {
                    // 使用html2canvas將列印區域轉換為圖像
                    html2canvas(printArea, {
                        scale: 2, // 提高解析度
                        useCORS: true, // 允許跨域圖片
                        logging: false, // 關閉日誌
                        backgroundColor: '#ffffff', // 確保背景為白色
                        allowTaint: true, // 允許污染
                        foreignObjectRendering: false // 不使用foreignObject渲染
                    }).then(function(canvas) {
                        try {
                            if (fileFormat === 'pdf') {
                                // 創建PDF
                                const imgData = canvas.toDataURL('image/jpeg', 1.0);
                                const pdf = new jsPDF({
                                    orientation: 'portrait',
                                    unit: 'mm',
                                    format: 'a4'
                                });
                                
                                // 計算PDF頁面尺寸
                                const imgWidth = 210; // A4寬度，單位mm
                                const pageHeight = 297; // A4高度，單位mm
                                
                                if (pageScale === 'fit') {
                                    // 自動縮放至一頁
                                    const imgHeight = canvas.height * imgWidth / canvas.width;
                                    
                                    // 如果內容高度超過A4高度，進行縮放
                                    if (imgHeight > pageHeight) {
                                        const scale = pageHeight / imgHeight;
                                        const scaledWidth = imgWidth * scale;
                                        
                                        // 居中放置
                                        const xOffset = (imgWidth - scaledWidth) / 2;
                                        pdf.addImage(imgData, 'JPEG', xOffset, 0, scaledWidth, pageHeight);
                                    } else {
                                        // 不需要縮放，直接添加
                                        pdf.addImage(imgData, 'JPEG', 0, 0, imgWidth, imgHeight);
                                    }
                                } else {
                                    // 實際大小
                                    const imgHeight = canvas.height * imgWidth / canvas.width;
                                    pdf.addImage(imgData, 'JPEG', 0, 0, imgWidth, imgHeight);
                                    
                                    // 如果內容超過一頁，添加新頁面
                                    let heightLeft = imgHeight;
                                    let position = 0;
                                    
                                    while (heightLeft > pageHeight) {
                                        position = heightLeft - pageHeight;
                                        pdf.addPage();
                                        pdf.addImage(imgData, 'JPEG', 0, -position, imgWidth, imgHeight);
                                        heightLeft -= pageHeight;
                                    }
                                }
                                
                                // 下載PDF
                                pdf.save(`${fileName}.pdf`);
                            } else if (fileFormat === 'png') {
                                // 下載PNG
                                const imgData = canvas.toDataURL('image/png');
                                const link = document.createElement('a');
                                link.href = imgData;
                                link.download = `${fileName}.png`;
                                document.body.appendChild(link);
                                link.click();
                                document.body.removeChild(link);
                            } else if (fileFormat === 'jpg') {
                                // 下載JPG
                                const imgData = canvas.toDataURL('image/jpeg', 0.9);
                                const link = document.createElement('a');
                                link.href = imgData;
                                link.download = `${fileName}.jpg`;
                                document.body.appendChild(link);
                                link.click();
                                document.body.removeChild(link);
                            }
                            
                            // 隱藏列印區域和載入指示器
                            printArea.style.display = 'none';
                            hideLoading();
                            
                            // 顯示下載成功通知
                            showDownloadToast();
                        } catch (error) {
                            console.error('檔案下載錯誤:', error);
                            alert('檔案下載發生錯誤，請稍後再試。');
                            printArea.style.display = 'none';
                            hideLoading();
                        }
                    }).catch(function(error) {
                        console.error('檔案生成錯誤:', error);
                        alert('檔案生成發生錯誤，請稍後再試。');
                        printArea.style.display = 'none';
                        hideLoading();
                    });
                }, 500);
            };
            
            // 設置圖片來源，觸發載入
            logoImg.src = "https://lh3.googleusercontent.com/d/1Hs-Ug0Yx_Nh9Ov9HlIRuGpLRJO-nTMqn";
            
            // 如果圖片已經在緩存中，可能不會觸發onload事件，所以添加一個備用計時器
            setTimeout(function() {
                if (!logoImg.complete) {
                    // 如果圖片還沒載入完成，顯示錯誤
                    alert('無法載入公司Logo，請確保網絡連接正常。');
                    printArea.style.display = 'none';
                    hideLoading();
                }
            }, 5000); // 5秒超時
        });

        // 重置表單
        document.getElementById('resetBtn').addEventListener('click', function() {
            // 重置A客戶資料
            document.getElementById('customerA_id').value = '';
            document.getElementById('customerA_name').value = '';
            document.getElementById('customerA_address').value = '';
            document.getElementById('customerA_phone').value = '';
            document.getElementById('customerA_expiry').value = '';
            document.getElementById('customerA_daysLeft').value = '';
            document.getElementById('customerAStatus').classList.add('hidden');
            
            // 重置B客戶資料
            document.getElementById('customerB_id').value = '';
            document.getElementById('customerB_name').value = '';
            document.getElementById('customerB_address').value = '';
            document.getElementById('customerB_phone').value = '';
            document.getElementById('customerB_currentExpiry').value = '';
            document.getElementById('customerB_newExpiry').value = '';
            document.getElementById('customerBStatus').classList.add('hidden');
            
            // 重置轉移設定
            document.getElementById('transferDate').value = formatDate(new Date());
            document.getElementById('transferDays').value = '';
            document.getElementById('transferNotes').value = '';
        });

        // 點擊遮罩關閉對話框
        document.getElementById('googleOverlay').addEventListener('click', function() {
            hideGoogleDialog();
        });

        // 設置今天日期為轉移日期的預設值
        document.getElementById('transferDate').value = formatDate(new Date());
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'96612015233bf209',t:'MTc1MzY3MTYxNy4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>






